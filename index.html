import React, { useState } from 'react';
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { motion } from "framer-motion";
import { CheckCircle2, XCircle } from "lucide-react";

export default function AwsInteractiveGuide() {
  const [activeStep, setActiveStep] = useState("s3");

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-6">
      <motion.h1
        className="text-3xl font-bold text-center text-gray-800 mb-2"
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
      >
        Interactive Guide to Secure Content Delivery
      </motion.h1>
      <p className="text-center text-gray-500 mb-8">
        Visualizing AWS CloudFront Setup with a Private S3 Bucket
      </p>

      <Tabs value={activeStep} onValueChange={setActiveStep} className="max-w-5xl mx-auto">
        <TabsList className="grid grid-cols-4 bg-white shadow rounded-xl mb-6">
          <TabsTrigger value="s3">1. Prepare S3 Bucket</TabsTrigger>
          <TabsTrigger value="oac">2. Create OAC</TabsTrigger>
          <TabsTrigger value="cloudfront">3. Build Distribution</TabsTrigger>
          <TabsTrigger value="test">4. Test & Verify</TabsTrigger>
        </TabsList>

        {/* Step 1: S3 Bucket */}
        <TabsContent value="s3">
          <Card className="shadow-lg">
            <CardContent className="p-6">
              <h2 className="text-xl font-semibold mb-4">Step 1: Prepare Your S3 Bucket</h2>
              <p className="text-gray-600 mb-4">
                The foundation of our setup is a secure, private S3 bucket. This will hold static content (HTML, CSS, JS, images), but it will not be directly accessible from the internet.
              </p>
              <ul className="space-y-3">
                <li className="flex items-start gap-2">
                  <CheckCircle2 className="text-green-600 mt-1" />
                  <span><strong>Create S3 Bucket:</strong> Choose a globally unique name for your bucket.</span>
                </li>
                <li className="flex items-start gap-2">
                  <CheckCircle2 className="text-green-600 mt-1" />
                  <span><strong>Upload Content:</strong> Add all your static files (HTML, CSS, JS, images).</span>
                </li>
                <li className="flex items-start gap-2">
                  <XCircle className="text-red-600 mt-1" />
                  <span><strong>Block Public Access:</strong> Enable this setting to ensure files are private.</span>
                </li>
              </ul>
              <div className="mt-6 text-right">
                <Button onClick={() => setActiveStep("oac")}>Next: Create OAC â†’</Button>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        {/* Step 2: OAC */}
        <TabsContent value="oac">
          <Card className="shadow-lg">
            <CardContent className="p-6">
              <h2 className="text-xl font-semibold mb-4">Step 2: Create an Origin Access Control (OAC)</h2>
              <p className="text-gray-600 mb-4">
                The OAC ensures CloudFront can securely access your private S3 bucket.
              </p>
              <ul className="space-y-3">
                <li>Navigate to <strong>CloudFront</strong> in AWS console.</li>
                <li>Create a new <strong>OAC</strong> under Security â†’ Origin Access.</li>
                <li>Assign a descriptive name (e.g., <code>my-s3-oac</code>).</li>
                <li>Copy the generated <strong>bucket policy</strong> and apply it in S3 permissions.</li>
              </ul>
              <div className="mt-6 text-right">
                <Button onClick={() => setActiveStep("cloudfront")}>Next: Build Distribution â†’</Button>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        {/* Step 3: CloudFront */}
        <TabsContent value="cloudfront">
          <Card className="shadow-lg">
            <CardContent className="p-6">
              <h2 className="text-xl font-semibold mb-4">Step 3: Create CloudFront Distribution</h2>
              <p className="text-gray-600 mb-4">
                CloudFront will cache and deliver your content globally for performance and security.
              </p>
              <ul className="space-y-3">
                <li>Choose your <strong>S3 bucket</strong> as the origin.</li>
                <li>Enable <strong>Origin Access Control</strong> with the OAC created earlier.</li>
                <li>Set viewer protocol policy to <strong>Redirect HTTP â†’ HTTPS</strong>.</li>
                <li>Allowed methods: <strong>GET, HEAD</strong>.</li>
                <li>Apply caching policy: <strong>CachingOptimized</strong>.</li>
                <li>Optionally add <strong>index.html</strong> as the default root object.</li>
              </ul>
              <div className="mt-6 text-right">
                <Button onClick={() => setActiveStep("test")}>Next: Test & Verify â†’</Button>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        {/* Step 4: Test */}
        <TabsContent value="test">
          <Card className="shadow-lg">
            <CardContent className="p-6">
              <h2 className="text-xl font-semibold mb-4">Step 4: Test Your Distribution</h2>
              <ul className="space-y-3">
                <li>Wait until status = <strong>Deployed</strong>.</li>
                <li>Copy the <strong>CloudFront domain name</strong> (e.g., <code>d1234abcd.cloudfront.net</code>).</li>
                <li>Test in your browser: <code>https://d1234abcd.cloudfront.net/index.html</code>.</li>
              </ul>
              <div className="mt-6 text-center">
                <Button variant="success">ðŸŽ‰ Done! Your site is live.</Button>
              </div>
            </CardContent>
          </Card>
        </TabsContent>
      </Tabs>
    </div>
  );
}
